# -*- coding: utf-8 -*-
""""бий ермек"

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1icjdi5R0JxPiaTbO6lPi49uEh6PCaUFT

# Проектная работа Основы интеллектуального анализа данных и машинного обучение

Выполнили: Испанов Ермек, Кульмагамбетов Бий

Часть 1. Подготовка данных
"""

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

"""1.1 Загрузка данных и первичный анализ данных"""

df = pd.read_csv('bank.csv')
df

df.shape

df.info()

df.describe()

df.isnull().sum()

"""1.2 Кодирование целевой переменной

Цель классификации — deposit
"""

df['deposit'] = df['deposit'].map({'yes': 1, 'no': 0})

"""1.3 Выбор признаков

Для линейной регрессии
"""

X_reg = df[['age', 'duration', 'campaign', 'previous']].values
y_reg = df['balance'].values

"""Для логистической регрессии"""

X_clf = df[['age', 'balance', 'duration', 'campaign']].values
y_clf = df['deposit'].values

"""1.4 Масштабирование признаков"""

def standardize(X):
    mean = X.mean(axis=0)
    std = X.std(axis=0)
    return (X - mean) / std

X_reg = standardize(X_reg)
X_clf = standardize(X_clf)

"""1.5 Добавление столбца единиц (intercept)"""

X_reg = np.c_[np.ones(X_reg.shape[0]), X_reg]
X_clf = np.c_[np.ones(X_clf.shape[0]), X_clf]

"""1.6 Мини-проверка размерностей"""

print(X_reg.shape, y_reg.shape)
print(X_clf.shape, y_clf.shape)

"""Часть 2. Линейная регрессия (реализация с нуля)

Формула линейной регрессии:
![Снимок экрана 2025-11-06 204024.png](data:image/png;base64,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)

Градиент функции потерь:

![Снимок экрана 2025-11-06 204116.png](data:image/png;base64,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)

2.1 Функция потерь (MSE)
"""

def mse(y_true, y_pred):
    return np.mean((y_true - y_pred) ** 2)

"""2.2 Batch Gradient Descent"""

def linear_regression_gd(X, y, lr=0.01, epochs=500):
    n_samples, n_features = X.shape
    w = np.zeros(n_features)

    losses = []

    for _ in range(epochs):
        y_pred = X @ w
        error = y_pred - y

        grad = (2 / n_samples) * (X.T @ error)
        w -= lr * grad

        losses.append(mse(y, y_pred))

    return w, losses

"""2.3 Обучение модели"""

weights, losses = linear_regression_gd(
    X_reg, y_reg,
    lr=0.01,
    epochs=500
)

"""2.4 График функции потерь"""

plt.figure(figsize=(6,4))
plt.plot(losses)
plt.xlabel('Epoch')
plt.ylabel('MSE')
plt.title('Сходимость градиентного спуска')
plt.show()

"""2.5 Найденные коэффициенты"""

intercept = weights[0]
coefficients = weights[1:]

print("Intercept:", intercept)
print("Coefficients:", coefficients)

"""2.6 Scatter plot + линия регрессии"""

feature_index = 1  # duration

x_vals = X_reg[:, feature_index]
y_vals = y_reg

y_line = intercept + coefficients[feature_index-1] * x_vals

plt.figure(figsize=(6,4))
plt.scatter(x_vals, y_vals, alpha=0.3)
plt.plot(x_vals, y_line, color='red')
plt.xlabel('Duration (standardized)')
plt.ylabel('Balance')
plt.title('Линейная регрессия')
plt.show()

"""2.7 Эксперимент с learning rate"""

lrs = [0.001, 0.01, 0.1]

plt.figure(figsize=(6,4))

for lr in lrs:
    _, losses_lr = linear_regression_gd(X_reg, y_reg, lr=lr, epochs=200)
    plt.plot(losses_lr, label=f'lr={lr}')

plt.legend()
plt.xlabel('Epoch')
plt.ylabel('MSE')
plt.title('Влияние learning rate')
plt.show()

"""Часть 3. Логистическая регрессия (реализация с нуля)

Сигмоида:

![Снимок экрана 2025-11-06 204228.png](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQMAAABkCAYAAACCV1WdAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAodSURBVHhe7d1/bNT1Hcfxp0sTb9Hr6Qg9Mq3dkFpRsDOBsplKpx63mFF0K0UjtTKKnZNWN2kXs67OpXbLoDJpYYuFLqPDRLhmjhZFDhZXTNx6/UOKDilExsE0/RKb8W0kHLHJd3+0X71+7Y9r76zc9fVI7g++7+/3SgJ93efz/ny+37vCsiwLEZnxvuI8ICIzk8JAREBhICI2hYGIgMJARGwKAxEBhYGI2BQGIgIKAxGxKQxEBBQGImJTGIgIKAxExKYwEBFQGIiITWEgIqAwEBGbwkBEQGEgIjaFgYiAwkBEbAoDST6DJqEthWQWNBF21mTKFAaSFCInOmnfUUfF2kKyMzLx1XZiXnKeJfFQGEhSMMMhgkcNvHdU0rZxhbMsCXCFvkRFks7+MtIfCMAt9bzzr0qynHWZEo0MRAQUBiJiUxiICCgMRMSmMBARUBiIiE1hICKgMBARm8JAREBhICI2hcFk9bdTMd9H0ylnIXbhbT4WV3diOgsytoiJYRgYhkHvieF7Ffv7OD18zOiPOK+QSdK9CZNhBilbUAbN79Jyr8dZnQSTYPkCymjh3WY/8bzTjGHfjzAW3acQN4VBzAxal2dTM/8QZzflOYuTNxii6ps+up5+hzfX67+wfPkUBjEy21aSuRZazrZRnKCP8qH3vMTW9zoovc5ZFZle6hnEYrCHxmeDuNZVJiwIADz3V1Lu6qTmhZCzJDLtFAaxONjIpjNeKh8ucFbik1bAqkdcmC82ErjgLIpML4VBDIKvBMB1H9+73VmJX97dhUA7rx92VkSm1wzsGUQwjTBH3uodfWnv6hwKluVEdfhDVGX4aL6rhXO7i3GNOPnzzKOtNO4IwV3VVP8ga+j8wV4CtV3c9NtScp0XGK0UZlfQ9eNDnEtEY1JkqqwZ5PxbjVbRPLfldo/3WmQ1vh91UbjRyne7rXnPHok6OLrjL+SPeK8FVQes859ctI435FuLxry+y9ow2225lzZap50lkWk0Y0YGvVvuZHFtD9zkp/qxUnKvDrO3oYbACWBZLbtKcoZOnJWLf+nwJzrAwQrSi1rJqXuH7ifHWQL8oBnf/CZu3lyPfxb0HdtLxyuH6TphELm9nu6/V5KT5rwIIEzTtxdSc6qcQ+caiGls0F3H4tJWzjuPx+iakpforonpJ8kMMiPCwNxfxoIHAvBg28hNPoOdVH29kGZPNW+erP38EJ7PNrsU7x6g5V5nMcoHPXReyqFg7mcTCbO7jqKn4Td/rSVvzFWICIEHMijbX0zbQAt+Z3lUEUzDZKp77lweL56J5jsy46R+A/FCkKceCWC6ytn1B8duv7RvkDUXME5jRB+fiutyRwbB4Sp8EwYBgAvPuPXRuPB4vXin+FIQyGhSfmQQaVtJxtog3g1vcvJXzs/+IBXpK2llnE/ljjLSV8cwMohitJWQ/8cl7Hu1kpwYfvGC5emsfHmcv8OXLD093XlIxjEwMOA8lBRSPgyGftFclB84R8N3HMW368gu2ISxdCsn95XidZRhEtOEYb1/LqTkYCn7dhbjHbVH4KRpglweUnyaEMG8ALCE2+Y6a9D72h4MYMWaVaMHAUDaVwE4at8pN47eLT5K/l3FoZdGBoGxv45Nb4y6kAkY9IUB17Vc4yyNpXsTvu/mkz/Fl+957XiUUThWF1LOgZ+4Lbe7yNrzsaNwfo9V5I5hSS/GpcXjL+Rbs3/4onX8o4sjjl98f6e1+nrHcuUIw0uL399p9TlLItMoxUcG4H+4HA9Bdu+P+mQ2Q9StKCM4t5yO9glue71hCUtcYBw7Meaw3Nxfhu/XfSzxBCnJziD9a5lkz88me34mGd+qIFy1i8pRRiYAGMfpjYB3ce7YoxOR6eBMh1TUF1htzXO7rUWr1lvrV+Vbs2fPs5Y/vdfq+8R55mguWnseclvu2RusLmfJGh5hXL/W2vvR8J//u8daHbWx6Z7nuqzzjktGeG2t5XbPtjZ0Ogsi0yvlG4ifipgYZmR4Wc4z4bbiaJG2EjLWdlHdeZJa5/0JERPj0pV4oztygxHMfhOu9uK5KvrkzwtVZ+DbWUrHhw0UxNRwFPlipPw04VMuz/A6++SCAMB1/6OUuwya/tLpLA29r7M1nza0D2CiIGCwkz07I2Q9+WhyBcGgSWhLIZkFTUzcVpVkMXPCIB5pBVRvLCCyo4nAWIsCU2D+rYnmiJ9nKoa3Ql/GIic6ad9RR8XaQrIzMvHVdmJecp41Qwya9LzSTPPB8HAfKUxgV2jMnlKyUBjEyLtmK/W3B3nquQQtyw2GqPtZEP+fWhL6wJQvihkOETxq4L2jkraNK5zl+J1pxndPMow0TAKPZHLnE3VUFS1k8ePNBKo3cOTGvEmPOC83CoOYZVHZ3ob/5SLKolcmpsQk+HgRu+9to2VlEiQB4F1WzdbGrdSu85N73ZXOcvwGLw3vCbnMmUf4X2E3A2fPMjBwjn25Xey9tZ5654a2JDRzGoiJ0t9ORX4jOa8eGnu5cALhbT5Wnq7l0KaC5Hwysv2k4kQ+kfhUE4sfgrZEvd+Eemh9YjsTj/M8FPy0nuJR/q2Ntgp+8XElLWsu/2leLBQGMnlJEgYRo4fDHe20HzXAm8ej61aR603EYD5C77Z1bL9hGw2FSRnno9I0QVKPGaKpKJuM+evYfeFmih+rpNgbomT+sri+/GaISah+Pa0Lo4Lg7WZajzrPSz4KA0ktZpCyBT5qQkvZdbKblieLKbglh4J1DTyzrIfWjvhalL1blrO8A+Z82EXPGYPw4SYKf9TFnBudZyYfhYGkkDBNK1YSMMH/+82smBVVMoO8/kYWK5bFMQn5Zw01g1s584/NZB1ez50Lsll4/17ytm/GP9GekiSgnoFM3hR7BuaxIJ29Y6zGn9vLhgao3ngfc5w1AFzk3O0nZ7wp+uEqMpY3E8HP1ve28b208xx/q5feY61s39JD1sZ9tMXT7LsQIXKV69MlxEi/CR4PrmTaMDYOjQwkZYQ6Woc2/txwidDv6qirbyIQCnNtXi37/nMyviAAiAoCANes1AkCNDKQKZniyGBcCVhNGHqQDRM/vFZGpZGBpJzbblIQTIXCQFJGzq3D04BBZ2WI2VFByYvxrSakMoWBxCZiYhgGhmHQaz8Crr+P08PHjP4xGoPTKGvNz/EDgV2Bkd+WFTHo3FLIogYvTzyoUcNY1DOQ2Nh9grHE2z9IQM8AwOxuouyhGoIeP6V3zKGv5wBdp+bg/+XzbC7Lw5NCDb9EUxjI5SFBYTAk6unRaR68sxKxBTn1aZogl4e0Kyd+GEzMor5kRkEQM40MRAQ0MhARm8JAREBhICI2hYGIgMJARGwKAxEBhYGI2BQGIgIKAxGxKQxEBBQGImJTGIgIKAxExKYwEBFQGIiITWEgIqAwEBGbwkBEQGEgIjaFgYiAwkBEbAoDEQGFgYjYFAYiAgoDEbEpDEQEgP8DafndgCxFyQAAAAAASUVORK5CYII=)

Модель:

![Снимок экрана 2025-11-06 204441.png](data:image/png;base64,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)

Функция потерь:

![Снимок экрана 2025-11-06 204501.png](data:image/png;base64,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)

Градиент:

![Снимок экрана 2025-11-06 204507.png](data:image/png;base64,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)

3.1 Сигмоида и Log Loss
"""

def sigmoid(z):
    return 1 / (1 + np.exp(-z))

def log_loss(y_true, y_pred):
    eps = 1e-9
    y_pred = np.clip(y_pred, eps, 1 - eps)
    return -np.mean(
        y_true * np.log(y_pred) + (1 - y_true) * np.log(1 - y_pred)
    )

"""3.2 Градиентный спуск (batch)"""

def logistic_regression_gd(X, y, lr=0.01, epochs=500):
    n_samples, n_features = X.shape
    w = np.zeros(n_features)

    losses = []

    for _ in range(epochs):
        z = X @ w
        y_pred = sigmoid(z)

        grad = (1 / n_samples) * (X.T @ (y_pred - y))
        w -= lr * grad

        losses.append(log_loss(y, y_pred))

    return w, losses

"""3.3 Обучение модели"""

weights_log, losses_log = logistic_regression_gd(
    X_clf, y_clf,
    lr=0.01,
    epochs=500
)

"""3.4 График функции потерь"""

plt.figure(figsize=(6,4))
plt.plot(losses_log)
plt.xlabel('Epoch')
plt.ylabel('Log Loss')
plt.title('Сходимость логистической регрессии')
plt.show()

"""3.5 Предсказания классов и вероятностей"""

y_proba = sigmoid(X_clf @ weights_log)
y_pred = (y_proba >= 0.5).astype(int)

"""3.6 Метрики"""

from sklearn.metrics import (
    accuracy_score,
    precision_score,
    recall_score,
    f1_score,
    confusion_matrix,
    roc_auc_score
)

print("Accuracy:", accuracy_score(y_clf, y_pred))
print("Precision:", precision_score(y_clf, y_pred))
print("Recall:", recall_score(y_clf, y_pred))
print("F1-score:", f1_score(y_clf, y_pred))
print("ROC AUC:", roc_auc_score(y_clf, y_proba))

"""3.7 Confusion Matrix"""

cm = confusion_matrix(y_clf, y_pred)

plt.figure(figsize=(4,4))
plt.imshow(cm)
plt.title('Confusion Matrix')
plt.colorbar()
plt.xticks([0,1], ['No', 'Yes'])
plt.yticks([0,1], ['No', 'Yes'])

for i in range(2):
    for j in range(2):
        plt.text(j, i, cm[i, j], ha='center', va='center')

plt.xlabel('Predicted')
plt.ylabel('Actual')
plt.show()

"""3.8 Эксперимент с learning rate"""

lrs = [0.001, 0.01, 0.1]

plt.figure(figsize=(6,4))

for lr in lrs:
    _, losses_lr = logistic_regression_gd(X_clf, y_clf, lr=lr, epochs=200)
    plt.plot(losses_lr, label=f'lr={lr}')

plt.legend()
plt.xlabel('Epoch')
plt.ylabel('Log Loss')
plt.title('Влияние learning rate')
plt.show()

"""Часть 4. Random Forest

4.1 Train / Test split
"""

from sklearn.model_selection import train_test_split

X_train, X_test, y_train, y_test = train_test_split(
    X_clf, y_clf,
    test_size=0.2,
    random_state=42,
    stratify=y_clf
)

"""4.2 Random Forest"""

from sklearn.ensemble import RandomForestClassifier

rf = RandomForestClassifier(
    n_estimators=100,
    max_depth=5,
    random_state=42
)

rf.fit(X_train, y_train)

"""4.3 Предсказания"""

y_pred_rf = rf.predict(X_test)
y_proba_rf = rf.predict_proba(X_test)[:, 1]

"""4.4 Метрики Random Forest"""

print("Random Forest")
print("Accuracy:", accuracy_score(y_test, y_pred_rf))
print("Precision:", precision_score(y_test, y_pred_rf))
print("Recall:", recall_score(y_test, y_pred_rf))
print("F1-score:", f1_score(y_test, y_pred_rf))
print("ROC AUC:", roc_auc_score(y_test, y_proba_rf))

"""4.5 Сравнение с логистической регрессией

Логистическая регрессия (на test)
"""

y_proba_log_test = sigmoid(X_test @ weights_log)
y_pred_log_test = (y_proba_log_test >= 0.5).astype(int)

print("Logistic Regression (from scratch)")
print("Accuracy:", accuracy_score(y_test, y_pred_log_test))
print("Precision:", precision_score(y_test, y_pred_log_test))
print("Recall:", recall_score(y_test, y_pred_log_test))
print("F1-score:", f1_score(y_test, y_pred_log_test))
print("ROC AUC:", roc_auc_score(y_test, y_proba_log_test))

"""4.6 Сравнительная таблица"""

results = pd.DataFrame({
    'Model': ['Logistic Regression', 'Random Forest'],
    'Accuracy': [
        accuracy_score(y_test, y_pred_log_test),
        accuracy_score(y_test, y_pred_rf)
    ],
    'F1-score': [
        f1_score(y_test, y_pred_log_test),
        f1_score(y_test, y_pred_rf)
    ],
    'ROC AUC': [
        roc_auc_score(y_test, y_proba_log_test),
        roc_auc_score(y_test, y_proba_rf)
    ]
})

results

"""Часть 5. Интерактивный интерфейс"""

import ipywidgets as widgets
from IPython.display import display, clear_output

X_train, X_test, y_train, y_test = train_test_split(
    X_clf, y_clf, test_size=0.2, random_state=42, stratify=y_clf
)

"""5.1 Универсальная функция запуска модели"""

def run_model(model_type, lr, epochs):
    clear_output()

    if model_type == 'Linear Regression':
        weights, losses = linear_regression_gd(X_reg, y_reg, lr=lr, epochs=epochs)

        plt.figure(figsize=(6,4))
        plt.plot(losses)
        plt.xlabel('Epoch')
        plt.ylabel('MSE')
        plt.title('Linear Regression Loss')
        plt.show()

        print("Intercept:", weights[0])
        print("Coefficients:", weights[1:])

    elif model_type == 'Logistic Regression':
        weights, losses = logistic_regression_gd(X_clf, y_clf, lr=lr, epochs=epochs)

        plt.figure(figsize=(6,4))
        plt.plot(losses)
        plt.xlabel('Epoch')
        plt.ylabel('Log Loss')
        plt.title('Logistic Regression Loss')
        plt.show()

        y_proba = sigmoid(X_test @ weights)
        y_pred = (y_proba >= 0.5).astype(int)

        print("Logistic Regression (from scratch) metrics:")
        print("Accuracy:", accuracy_score(y_test, y_pred))
        print("Precision:", precision_score(y_test, y_pred))
        print("Recall:", recall_score(y_test, y_pred))
        print("F1-score:", f1_score(y_test, y_pred))
        print("ROC AUC:", roc_auc_score(y_test, y_proba))

        # Confusion matrix
        cm = confusion_matrix(y_test, y_pred)
        plt.figure(figsize=(4,4))
        plt.imshow(cm, cmap='Blues')
        plt.title('Confusion Matrix')
        plt.colorbar()
        plt.xticks([0,1], ['No', 'Yes'])
        plt.yticks([0,1], ['No', 'Yes'])
        for i in range(2):
            for j in range(2):
                plt.text(j, i, cm[i, j], ha='center', va='center', color='red')
        plt.xlabel('Predicted')
        plt.ylabel('Actual')
        plt.show()

    elif model_type == 'Random Forest':
        rf = RandomForestClassifier(n_estimators=100, max_depth=5, random_state=42)
        rf.fit(X_train, y_train)
        y_pred_rf = rf.predict(X_test)
        y_proba_rf = rf.predict_proba(X_test)[:, 1]

        print("Random Forest metrics:")
        print("Accuracy:", accuracy_score(y_test, y_pred_rf))
        print("Precision:", precision_score(y_test, y_pred_rf))
        print("Recall:", recall_score(y_test, y_pred_rf))
        print("F1-score:", f1_score(y_test, y_pred_rf))
        print("ROC AUC:", roc_auc_score(y_test, y_proba_rf))

        # Confusion matrix
        cm = confusion_matrix(y_test, y_pred_rf)
        plt.figure(figsize=(4,4))
        plt.imshow(cm, cmap='Greens')
        plt.title('Confusion Matrix')
        plt.colorbar()
        plt.xticks([0,1], ['No', 'Yes'])
        plt.yticks([0,1], ['No', 'Yes'])
        for i in range(2):
            for j in range(2):
                plt.text(j, i, cm[i, j], ha='center', va='center', color='red')
        plt.xlabel('Predicted')
        plt.ylabel('Actual')
        plt.show()

"""5.2 Виджеты управления"""

model_selector = widgets.Dropdown(
    options=['Linear Regression', 'Logistic Regression', 'Random Forest'],
    value='Linear Regression',
    description='Model:'
)

lr_slider = widgets.FloatLogSlider(
    value=0.01,
    base=10,
    min=-4,
    max=0,
    step=0.1,
    description='LR:'
)

epochs_slider = widgets.IntSlider(
    value=300,
    min=100,
    max=1000,
    step=100,
    description='Epochs:'
)

run_button = widgets.Button(description='Run Model')

def on_button_click(b):
    run_model(model_selector.value, lr_slider.value, epochs_slider.value)

run_button.on_click(on_button_click)

display(
    model_selector,
    lr_slider,
    epochs_slider,
    run_button
)